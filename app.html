<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Field Visit App</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f4f6f8;
}

/* LAYOUT */
.app {
  display: flex;
  height: 100vh;
}

/* SIDEBAR */
.sidebar {
  width: 220px;
  background: #1f3a5f;
  color: white;
  padding-top: 20px;
}

.sidebar h2 {
  text-align: center;
  margin-bottom: 20px;
  font-size: 18px;
}

.sidebar button {
  width: 100%;
  padding: 12px;
  background: none;
  color: white;
  border: none;
  text-align: left;
  cursor: pointer;
  font-size: 14px;
}

.sidebar button:hover {
  background: #16304f;
}

/* MAIN */
.main {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
}

.container {
  max-width: 600px;
  background: white;
  padding: 20px;
  border-radius: 8px;
}

.hidden {
  display: none;
}

/* FORM */
label { display: block; margin-top: 10px; }
input, select, textarea, button {
  width: 100%;
  padding: 8px;
  margin-top: 5px;
}
textarea { min-height: 60px; }

.action-btn {
  margin-top: 15px;
  background: #1f3a5f;
  color: white;
  border: none;
  padding: 10px;
}
.sub-box {
  background: #eef1f5;
  padding: 10px;
  margin-top: 10px;
}
</style>
</head>

<body>

<div class="app">

  <!-- SIDEBAR -->
  <div class="sidebar">
    <h2>Field Visit</h2>

    <button onclick="showSection('dashboard')">üìä Dashboard</button>
    <button onclick="showSection('visit')">üìù Visit Entry</button>
    <button onclick="showSection('users')" id="userMenu">üë• User Management</button>
    <button onclick="logout()">üö™ Logout</button>
  </div>

  <!-- MAIN CONTENT -->
  <div class="main">

    <!-- DASHBOARD -->
    <div class="container hidden" id="dashboardBox">
      <h3>Dashboard</h3>
      <p>Summary & reports will appear here.</p>
    </div>

    <!-- USER MANAGEMENT -->
    <div class="container hidden" id="userMgmtBox">
      <h3>User Management</h3>

      <label>Name</label>
      <input id="um_name">

      <label>Mobile</label>
      <input id="um_mobile">

      <label>Password</label>
      <input id="um_password" type="password">

      <label>Role</label>
      <select id="um_role">
        <option>BDO</option>
        <option>ABDM</option>
        <option>SR_ABDM</option>
        <option>GM</option>
      </select>

      <button class="action-btn" onclick="createUser()">Create User</button>
    </div>

    <!-- VISIT ENTRY -->
    <div class="container hidden" id="visitBox">
      <h3>Add Visit</h3>

      <label>Client</label>
      <select id="clientSelect"></select>
      <button class="action-btn" onclick="toggleNewClient()">‚ûï Add New Client</button>

      <div class="sub-box hidden" id="newClientBox">
        <label>Client Name</label>
        <input id="nc_name">
        <label>Speciality</label>
        <input id="nc_speciality">
        <label>Hospital</label>
        <input id="nc_hospital">
        <label>Area</label>
        <input id="nc_area">
        <label>Type</label>
        <select id="nc_type">
          <option>Doctor</option>
          <option>Hospital</option>
          <option>Diagnostic</option>
          <option>Corporate</option>
        </select>
        <button class="action-btn" onclick="addClient()">Save Client</button>
      </div>

      <label>HQ / Ex-Station</label>
      <select id="hq"><option>HQ</option><option>Ex-Station</option></select>

      <label>Co-working</label>
      <input id="coworking">

      <label>Discussion</label>
      <textarea id="discussion"></textarea>

      <button class="action-btn" onclick="submitVisit()">Submit Visit</button>
    </div>

  </div>
</div>

<script>
const API = "https://script.google.com/macros/s/AKfycbz6mMdysUMHtbbG1yoIsk4Y__k2ARb8H_qIsbUZ5FcafGs-BgC8msbY21oBvWfMcka1/exec";
const user = JSON.parse(localStorage.getItem("user"));
if (!user) location.href = "login.html";

/* ROLE VISIBILITY */
if (user.role !== "ADMIN") {
  document.getElementById("userMenu").style.display = "none";
}

/* SECTION HANDLER */
function showSection(section) {
  dashboardBox.classList.add("hidden");
  visitBox.classList.add("hidden");
  userMgmtBox.classList.add("hidden");

  if (section === "dashboard") dashboardBox.classList.remove("hidden");
  if (section === "visit") visitBox.classList.remove("hidden");
  if (section === "users") userMgmtBox.classList.remove("hidden");
}

/* DEFAULT SCREEN */
showSection(user.role === "GM" ? "dashboard" : "visit");

/* LOGOUT */
function logout() {
  localStorage.clear();
  location.href = "login.html";
}

/* PLACEHOLDERS */
function createUser() { alert("Backend connect next"); }
function toggleNewClient() { newClientBox.classList.toggle("hidden"); }
function addClient() {}
function submitVisit() {}
</script>

</body>
</html>
