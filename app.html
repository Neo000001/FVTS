<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Field Visit System</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: #f4f6f8;
}
.app {
  display: flex;
  height: 100vh;
}

/* SIDEBAR */
.sidebar {
  width: 230px;
  background: #1f3a5f;
  color: #fff;
  display: flex;
  flex-direction: column;
}
.sidebar h2 {
  text-align: center;
  padding: 15px 0;
  margin: 0;
  border-bottom: 1px solid #16304f;
}
.sidebar button {
  padding: 12px 15px;
  border: none;
  background: none;
  color: #fff;
  text-align: left;
  cursor: pointer;
  font-size: 14px;
}
.sidebar button:hover {
  background: #16304f;
}

/* MAIN */
.main {
  flex: 1;
  padding: 20px;
  overflow-y: auto;
}
.section {
  display: none;
}
.section.active {
  display: block;
}
.container {
  background: #fff;
  padding: 20px;
  border-radius: 8px;
}
.note {
  color: #777;
  font-size: 13px;
}
</style>
</head>

<body>

<div class="app">

  <!-- SIDEBAR -->
  <div class="sidebar">
    <h2>Field Visit</h2>

    <button id="menuDashboard" onclick="showSection('dashboard')">ğŸ“Š Dashboard</button>
    <button id="menuVisits" onclick="showSection('visits')">ğŸ“ Visits / Site Entry</button>
    <button id="menuReports" onclick="showSection('reports')">ğŸ“‘ Reports</button>
    <button id="menuUsers" onclick="showSection('users')">ğŸ‘¥ User Management</button>
    <button id="menuSettings" onclick="showSection('settings')">âš™ï¸ Settings</button>

    <button onclick="logout()">ğŸšª Logout</button>
  </div>

  <!-- MAIN CONTENT -->
  <div class="main">

    <!-- DASHBOARD -->
    <div id="dashboard" class="section">
      <div class="container">
        <h3>Dashboard</h3>
        <p class="note">
          KPIs & charts will appear here<br>
          (Total visits, pending follow-ups, user activity)
        </p>
      </div>
    </div>

    <!-- VISITS -->
    <div id="visits" class="section">
      <div class="container">
        <h3>Visits / Site Entry</h3>
        <p class="note">
          Visit entry form + visit history will be here
        </p>
      </div>
    </div>

    <!-- REPORTS -->
    <div id="reports" class="section">
      <div class="container">
        <h3>Reports</h3>
        <p class="note">
          Date / User / Branch filters<br>
          Follow-up reports, export later
        </p>
      </div>
    </div>

    <!-- USER MANAGEMENT -->
    <div id="users" class="section">
      <div class="container">
        <h3>User Management</h3>
        <p class="note">
          Create, edit, activate / deactivate users
        </p>
      </div>
    </div>

    <!-- SETTINGS -->
    <div id="settings" class="section">
      <div class="container">
        <h3>Settings</h3>
        <p class="note">
          Password reset (self & admin reset)
        </p>
      </div>
    </div>

  </div>
</div>

<script>
/* ===== CONFIG ===== */
const API = "https://script.google.com/macros/s/AKfycbyX4vdPwU1bHeiXFHAMt5usBueFtsbS4_pEo73tDUOxdNm2wNASpbI8EtFLOSTnqhJJGw/exec";

/* ===== SESSION ===== */
const user = JSON.parse(localStorage.getItem("user"));
if (!user) {
  window.location.href = "login.html";
}

/* ===== ROLE-BASED MENU VISIBILITY ===== */
if (user.role === "BDO" || user.role === "ABDM") {
  hide("menuDashboard");
  hide("menuReports");
  hide("menuUsers");
  hide("menuSettings");
}

if (user.role === "GM") {
  hide("menuVisits");
  hide("menuUsers");
}

if (user.role === "SR_ABDM") {
  hide("menuUsers");
}

/* ===== DEFAULT LANDING ===== */
if (user.role === "ADMIN" || user.role === "GM" || user.role === "SR_ABDM") {
  showSection("dashboard");
} else {
  showSection("visits");
}

/* ===== FUNCTIONS ===== */
function hide(id) {
  document.getElementById(id).style.display = "none";
}

function showSection(sectionId) {
  document.querySelectorAll(".section").forEach(s => s.classList.remove("active"));
  document.getElementById(sectionId).classList.add("active");
}

function logout() {
  localStorage.clear();
  window.location.href = "login.html";
}
</script>

</body>
</html>
